---
title: "Electricity Generation and Environmental Justice Communities in North Carolina"
author: "Fiona Price, Summer Heschong, and Asreeta Ushasri"
date: "2024-12-12"
output:
  pdf_document: default
  html_document: default
editor_options:
  chunk_output_type: console
---

\newpage
\tableofcontents 
\newpage
\listoftables 
\newpage
\listoffigures 
\newpage

```{r setup, echo=FALSE}
knitr::opts_chunk$set(include = FALSE)
# Load your packages

library(dplyr)
library(ggplot2)
library(here)
library(tidyverse)
library(readxl)
library(sf)
library(mapview)
library(viridis)
library(readr)
library(tigris)

# Check your working directory

getwd()
here()

# Set your ggplot theme

default_theme <- theme_light() +
  theme(panel.background = element_rect(color = "white"),
  legend.key = element_rect(color = "white"),
    legend.position = 'right',
    complete = TRUE)

theme_set(default_theme)

# Load your datasets

energy_data <-
  read_csv("./Data/Processed/NC_PowerPlants.csv")

nc_energy_total_cap <-
  read_csv("./Data/Processed/NC_Total_Capacity.csv")

nc_energy_emissions <-
  read_csv("./Data/Processed/NC_Energy_Emissions.csv")

nc_plants <- energy_data %>% 
    st_as_sf(coords = c("Plant longitude","Plant latitude"), 
             crs=4269) 

nc_plant_emissions <- energy_data %>% 
    st_as_sf(coords = c("Plant longitude","Plant latitude"), 
             crs=4269)

nc_EJ_powerplants <- read_csv("./Data/Processed/NC_joined.csv")

nc_plants_counties <- st_read('Data/Processed/nc_plants_EJ.gpkg')

EJ_NC_sf <- st_read("./Data/Processed/NC_Env_Justice.gpkg")

#County spatial data

nc_counties <- st_read(
  here("./Data/Spatial/North_Carolina_State_and_County_Boundary_Polygons.shp")) 

```


# Rationale and Research Questions

1. What is the distribution and capacity of power plants generating electricity in North Carolina?
2. Does electricity generation impact air quality through criteria air pollutant emissions in North Carolina?
3. What are the Environmental Justice implications of electricity power generation in North Carolina? Are power plants primarily located in low-income and disadvantaged communities?


\newpage

# Dataset Information

The eGRID 2022 data set provides information on electricity generation in the United States. The U.S. EPA publishes this data to describe capacity and geographic distribution of different energy resources. The 2022 data is the most recent data (published in 2024), because it requires time to process and compile this national data into a workbook.

This project utilizes the Plant 2022 and the Generator 2022 data sheets. The Plant 2022 data sheet describes the capacity, location, and primary fuel source of every power plant in the United States. The Generator 2022 worksheet focuses on individual generators. Power plants often have multiple generators of various fuel types, (such as natural gas combined cycle plants). For this reason, the U.S. EPA includes a separate worksheet for generators specifically.

To understand the impact of electricity generation on environmental justice, this project

Lastly, this project incorporates spatial data to understand the geographic relation between plants, as well as between plants and environmental justice (EJ) communities. The spatial data is from NC OneMap; it includes a vector polygon dataset delineating official boundaries of the North Carolina counties (in addition to the North Carolina state boundary as well). 

\newpage

# Exploratory Analysis 

```{r fig1, fig.cap="Total capacity (in MW) for each type of power plant in North Carolina. Gas, solar, and nuclear have the highest total capacity."}
#view(nc_energy_total_cap)
#colnames(energy_data)

NC_Plant_Cap_Plot <- ggplot(data = nc_energy_total_cap) +
  geom_bar(aes(x = `Plant primary fuel category`,
               y = `total_capacity`), fill = 'darkblue',
           stat = "identity") +
  labs(title = "Power Plant Capacity in North Carolina",
       x = "Plant Primary Fuel Category",
       y = "Nameplate Capacity (MW)")

print(NC_Plant_Cap_Plot)
```

```{r fig2, fig.cap="Number of power plants in North Carolina by fuel type. Solar, oil, and hydro are the most common.", echo=FALSE}
#Find the frequency of each type of fuel category
plant_counts <- nc_plants %>%
  group_by(`Plant primary fuel category`) %>%
  summarize(Count = n())
#Plot it
FuelType_Count_Plot <- 
  ggplot(plant_counts, aes(x = `Plant primary fuel category`, y = Count, 
                         fill = `Plant primary fuel category`)) +
  geom_bar(stat = "identity") +  
  geom_text(aes(label = Count), vjust = -0.5, size = 2.5) +
  labs(title = "Number of Plants by Fuel Type",
       x = "Fuel Type", y = "Number of Plants") +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.3, size = 8)) +
  scale_fill_viridis(discrete = TRUE, option = "C")

print(FuelType_Count_Plot)
```

```{r fig3, fig.cap="Average capacity for each type of fuel category. Nuclear has the highest average capacity per plant.", echo=FALSE}
#Find the frequency of each type of fuel category
plant_capacity <- nc_plants %>%
  group_by(`Plant primary fuel category`) %>%
  summarize(average_capacity = mean(`Plant nameplate capacity (MW)`))
#Plot it
FuelCapacity_Plot <- 
  ggplot(plant_capacity) +
  geom_bar(aes(x = `Plant primary fuel category`, 
               y = average_capacity),
           stat = "identity",
              fill = 'darkblue')+
  labs(title = "Average Capacity (MW) by Fuel Type",
       x = "Fuel Type", y = "Average Capacity (MW)") +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.3, size = 8))
print(FuelCapacity_Plot)
```

As shown in Figure \@ref(fig:fig1), natural gas generates the largest capacity of electricity power in North Carolina. The sum of natural gas power plants' nameplate capacities outranks solar, nuclear and coal. This follows broader trends in the United States. After technological advances in horizontal drilling and shale fracking in the 2010s, natural gas became economically more efficient to process (Rapier, 2024). Natural gas has therefore transformed into a primary fuel source for electricity generation in the United States.

Although natural gas contributes the most to electricity capacity in North Carolina, the number of solar power plants in the state is notably high, displayed in Figure \@ref(fig:fig2). This indicates that North Carolina likely hosts numerous, small solar power plants across the state. Solar power plants are small in capacity, but remain the most popular renewable resource in the state.


```{r fig4, fig.cap="Location of power plants in NC, colored by fuel category. Most power plants are solar.", echo=FALSE}
#Mapping capacity of electricity generation in NC

#Convert capacity to numeric
nc_plants$`Plant nameplate capacity (MW)` <-
  as.numeric(nc_plants$`Plant nameplate capacity (MW)`)

#Color by fuel category
Plant_Location_Color_Plot <- 
  ggplot() +
  geom_sf(data = nc_counties, fill = "grey") +
  geom_sf(data = nc_plants,
          aes(color = nc_plants$`Plant primary fuel category`)) +
  labs(color = "Fuel Category",
       title = "Spatial Distribution of Power Plants in NC") +
  theme(legend.text = element_text(size = 8),
        legend.title = element_text(size = 8)) +
   scale_color_viridis_d(option = "C")

print(Plant_Location_Color_Plot)
```

```{r fig5, fig.cap="Location of power plants in NC, sized by capacity (MW). Despite solar plants being common, they have less capacity.", echo=FALSE}
#Size by capacity
#Ggplot option
Plant_Location_Size_Plot <- 
  ggplot() +
  geom_sf(data = nc_counties, fill = "grey") +
  geom_sf(data = nc_plants,
          aes(size = nc_plants$`Plant nameplate capacity (MW)`,
                                color = "red")) +
  labs(title =
         "Spatial Distribution of Power Plants in NC, Sized by Capacity",
       size = "Capacity (MW)") +
  default_theme +
  theme(legend.position = "bottom") +
  guides(color = "none")

print(Plant_Location_Size_Plot)
```
While the number of solar power plants is large, Figure \@ref(fig:fig3) showcases that each solar plant contains a relatively small electricity generation capacity. The natural gas and coal power plants, though lower in number, producer a larger share of electric power in the state.

In North Carolina, natural gas power plants are absent from the atlantic coast area as depicted in Figure \@ref(fig:fig4). For the most part, natural gas power plants are instead located slightly inland (though spread across counties).
Solar power plants are evenly throughout the state of North Carolina, depicted, except in Western North Carolina along the Appalachian range. In this mountainous region, hydro power plants are more common than solar power plants.


```{r fig6, fig.cap="Map of disadvantaged communities in NC. Disadvantaged census tracts are shown in red.", echo=FALSE}
#Map which counties are classified as disadvantaged
#Set colors for disadvantaged vs. not
disadvantaged_colors <- c("False" = "grey", "True" = "red")

disadvantaged_map_ggplot <- ggplot(EJ_NC_sf) +
  geom_sf(aes(fill = Identified.as.disadvantaged), size = 0.1) +
  scale_fill_manual(
    values = disadvantaged_colors,
    na.value = "white", 
    name = "Disadvantaged Status") +
  labs(title = "Disadvantaged Census Tracts in NC") +
  theme(legend.position = "bottom")
print(disadvantaged_map_ggplot)
```

```{r fig7, fig.cap="Map of disadvantaged communities in NC along with power plants. Disadvantaged census tracts are shown in red.", echo=FALSE}
#Map plants and disadvantaged counties together

disadvantaged_tracts_map_ggplot <- ggplot() +
  geom_sf(data = EJ_NC_sf, aes(fill = Identified.as.disadvantaged), 
          color = "black", size = 0.1) +
  geom_sf(data = nc_plants, aes(geometry = geometry), 
          color = "blue", size = 1, shape = 21, fill = "blue") +
  scale_fill_manual(
    values = disadvantaged_colors,
    na.value = "white",  
    name = "Disadvantaged Status") +
  labs(title = "Disadvantaged Census Tracts \nand Power Plant Locations in NC") +
  theme(legend.position = "bottom")
print(disadvantaged_tracts_map_ggplot)
```


Figure \@ref(fig:fig6) maps census tract disadvantaged status, while Figure \@ref(fig:fig7) maps census tract disadvantaged status and power plant location. A few disadvantaged counties have a concentration of power plants in the Southern area of the state. However, the Raleigh metropolitan area is not classified as disadvantaged, but also has a notable concentration of power plants. Therefore, further investigation is required to understand if any correlation exists between census tract status and power plant locations.

The fuel type of the power plant also impacts front-line communities. Coal and natural gas power plants influence air quality due to the release of criteria air pollutants such as NOx. There are a handful of natural gas and oil power plants located around Robeson and Scotland county, but there are also many solar power plants in these areas. The Raleigh metropolitan area also has a couple of natural gas power plants.

This project aims to explore primary fuel type of electricity generation along with environmental justice to determine if any spatial patterns or injustices exist regarding electricity generation in North Carolina.


\newpage

# Analysis

## Question 1: What is the distribution and capacity of power plants generating electricity in North Carolina?

### Question 1a: Which type of plant has the highest capacity?

The exploratory analysis above investigates which plant fuel category has the highest capacity. In total, gas, solar, nuclear, and coal have the highest generation capacities (Figure \@ref(fig:fig1)). However, this does not reflect the average capacity for each fuel type, as shown in Figure \@ref(fig:fig3). As displayed in this graph, nuclear has the highest average capacity, followed by coal, gas, wind, hydro, other, biomass, oil, and solar. Although gas has the highest total capacity, each individual plant has a lower average capacity than nuclear and coal. This suggests there is a greater quantity of gas plants than nuclear or coal.

### Question 1b: Which type of plant is the most common?

Figure \@ref(fig:fig2) shows the number of each type of plant. Solar is by far the most common, followed by oil, hydro, biomass, and gas. The reason solar does not have the highest total capacity in MW for NC (despite being the most common) is that it has the lowest average capacity for each plant (Graph X).

### Question 1c: Where are most plants located?

As depicted in Figure \@ref(fig:fig8), the ten counties with the most power plants are, in order, Robseon, Duplin, Wayne, Nash, Cleveland and Johnston (tied at 29), and Bladen, Catawba, Halifax, and Randolph (all tied at 17). To understand the breakdown of power plants by fuel type in the county with the most plants (Robeson), this county was isolated for analysis (Figure \@ref(fig:fig9)). The primary power plant type in Robeson County was solar (41 plants, versus biomass (2) and oil (1)).


```{r fig8, fig.cap="Top ten counties with the most power plants. Robeson has the most plants in NC (44 total).", echo=FALSE}
#Where are most plants located?
county_counts <- nc_plants %>% 
  group_by(County.Name) %>% 
  summarize(plant.counts = n())
#Plot the counties with the top 10 highest number of plants.
most_plants_counties <- county_counts %>% 
  filter(plant.counts >= 17)

Plants_by_County_Plot <- ggplot(most_plants_counties, 
                aes(x = fct_reorder(`County.Name`,
                                    plant.counts, .desc = TRUE), 
                y = plant.counts, 
                fill = plant.counts)) +
  geom_bar(stat = "identity") +  
  geom_text(aes(label = plant.counts), vjust = -0.5, size = 2.5) +
  labs(title = "Number of Plants per County",
       x = "County", y = "Number of Plants",
       fill = "County Name") +
  default_theme +
  theme(axis.text.x = element_text(angle = 45,
                                   hjust = 0.3, size = 8)) +
  scale_fill_viridis(option = "C") 

print(Plants_by_County_Plot)
#This plot shows the top 10 counties with the most plants. Robeson county has
#the highest number of plants.
```

```{r fig9, fig.cap="Breakdown of plant primary fuel category for Robeson's 44 plants. Most plants in Robeson are solar.", echo=FALSE}
#Plot the breakdown of plant type for Robeson only. 
#First, filter for Robeson.
Robeson <- nc_plants %>% 
  filter(nc_plants$County.Name == "Robeson")
#Find the frequency of each type of fuel category
Robeson_fuel <- Robeson %>%
  group_by(`Plant primary fuel category`) %>%
  summarize(Count = n())

#Now plot by fuel type.
Robeson_Plot <- 
  ggplot(Robeson_fuel, aes(x = `Plant primary fuel category`, y = Count, 
                         fill = `Plant primary fuel category`)) +
  geom_bar(stat = "identity") +  
  geom_text(aes(label = Count), vjust = -0.5, size = 2.5) +
  labs(title = "Number of Plants by Fuel Type", 
       subtitle = "Robeson County",
       x = "Fuel Type", y = "Number of Plants",
       fill = "Plant Primary Fuel Category") +
  default_theme +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.3, size = 8)) +
  scale_fill_viridis_d(option = "C") 

print(Robeson_Plot)
#Robeson County has primarily solar plants.
```


## Question 2: Does electricity generation impact air quality through criteria air pollutant emissions in North Carolina?

### Question 2a: How do power plants contribute to carbon dioxide equivalent emissions in North Carolina?
As shown in the bar chart on CO2 Equivalent Emissions (Figure \@ref(fig:fig10)), only natural gas and coal-fired power plants release large quantities of carbon emissions when generating electricity.
Analyzing this spatially (Figure \@ref(fig:fig11)), coal and natural gas power plants release more carbon dioxide equivalent emissions than renewable resources. This impacts counties with and without the disadvantaged status. Emissions from natural gas power plants in particular border disadvantaged communities, even when the power plant itself is not located in a disadvantaged community.

This influences the cumulative environmental justice impacts in a community. Cumulative impacts is the combination of chemical and environmental stressors from multiple pathways which influence the health and well-being of a community (Bakkensen et al., 2024). In essence, cumulative impacts account for different sectors of the environment, such as air quality and water quality, which are typically management by different public departments. Because air quality and water quality are monitored separately, recognizing the overlapping effect that two separate environmental stressors have on a community is crucial to creating equitable environmental policies. Therefore, exposure to air pollutants on top of economic disadvantage harms the larger health outcomes of North Carolina counties.

### Question 2b: What is the distribution of NOx emissions from power plants in North Carolina?
NOx is listed as one of the six criteria air pollutants by the U.S. EPA (Suh et al., 2000). Nitric oxides react with volatile organic compounds and sunlight to produce ground-level ozone (Suh et al., 2000). Ground-level ozone reacts negatively with lung tissue, causing burning in the lungs and breathing difficulties for vulnerable populations such as young kids, elderly adults, and individuals with disabilities or asthma (Suh et al., 2000).

Mapping NOx emissions along with census tracts (Figure \@ref(fig:fig12)) reveals that counties with and without disadvantaged status face NOx emissions when located close to fossil fuel power plants. Examining correlation between census tract disadvantaged status and power plant location will reveal if power plants are disproportionately located close to disadvantaged communities. Given that natural gas and coal plants release high levels of NOx and carbon emissions, proximity to these power plants could impact public health outocmes.

### Question 2c: What is the distribution of SO2 emissions from power plants in North Carolina?
SO2 is another criteria air pollutant tracked by the U.S. EPA (Saxena, 2019). Sulfur dioxide contributes to acid rain, which deteriorates building materials and plant life. Acid rain does not directly impact human health, but indigesting and inhaling acidic compounds formed from sulfur is dangerous for humans (Saxena, 2019). This can also impact pulmonary issues (Saxena, 2019).

As depicted in the map of SO2 emissions (Figure \@ref(fig:fig13)), coal power plants contribute the most to sulfur dioxide. This is one of the advantages to natural gas. Natural gas does not release as much sulfur as coal combustion. The nation-wide trend of shifting from coal to natural gas reduces the sulfure released in the air. Determining the impact of power plant proximity on disadvantaged communities requires further investigation into the correlation between location and environmental justice communities.

```{r fig10, fig.cap="CO2 equivalent emissions from electricty fuel type in NC. Gas and coal are the only two types that produce CO2 emissions, warning=FALSE, with gas producing the most.", echo=FALSE}
#Examine emissions by fuel type in North Carolina

NC_Plant_CO2e_Plot <- ggplot(data = nc_energy_emissions) +
  geom_bar(aes(x = `Plant primary fuel category`,
               y = `total_CO2e`), fill = 'darkred',
           stat = "identity") +
  default_theme +
  labs(title = "CO2 Equivalent Emissions from
       Electricity Fuel Type in North Carolina",
       x = "Plant Primary Fuel Category",
       y = "CO2 Equivalent Emissions (Tons)")

print(NC_Plant_CO2e_Plot)
```

```{r fig11, fig.cap="Disadvantaged census tracts and power plant CO2 emissions (tons) in NC. The black circles represent emissions; the larger the circle, warning=FALSE, the greater the power plant's emissions.", echo=FALSE}
#Create map on CO2 Equivalent Emissions by Fuel Type

disadvantaged_plant_emissions_map <- ggplot() +
  geom_sf(data = EJ_NC_sf, aes(fill = Identified.as.disadvantaged), 
          size = 0.1) +
  geom_sf(data = nc_plant_emissions, 
          aes(size = `Plant annual CO2 equivalent emissions (tons)`)) +
            scale_fill_manual(
    values = disadvantaged_colors,
    na.value = "white",  
    name = "Disadvantaged Status")+
  scale_size_continuous(
    name = "CO2 Emissions (Tons)",
    range = c(1, 6)) + 
  labs(title = "Disadvantaged Census Tracts and\nPower Plant CO2 Emissions in NC") +
  theme(legend.position = "bottom") +
  guides(size = "none")

# Print the map
print(disadvantaged_plant_emissions_map)
```

```{r fig12, fig.cap="Disadvantaged census tracts and power plant NOx emissions (tons) in NC. The black circles represent emissions; the larger the circle, warning=FALSE, the greater the power plant's emissions.", echo=FALSE}
#Analyze NOx
#EPA defines this as a dangerous pollutant for public health
nox_emissions_map <- ggplot() +
  geom_sf(data = EJ_NC_sf, aes(fill = Identified.as.disadvantaged), 
          size = 0.1) +
  geom_sf(data = nc_plant_emissions, 
          aes(size = `Plant annual NOx emissions (tons)`)) +
            scale_fill_manual(
    values = disadvantaged_colors,
    na.value = "white",  
    name = "Disadvantaged Status")+
  scale_size_continuous(
    name = "NOx Emissions (Tons)",
    range = c(1, 6)) + 
  labs(title = "Disadvantaged Census Tracts and\nPower Plant NOx Emissions in NC") +
  theme(legend.position = "bottom") +
  guides(size = "none")

print(nox_emissions_map)
```

```{r fig13, fig.cap="Disadvantaged census tracts and power plant SO2 emissions (tons) in NC. The black circles represent emissions; the larger the circle, warning=FALSE, the greater the power plant's emissions.", echo=FALSE}
#Analyze SO2
#EPA defines this as a dangerous pollutant for public health
so2_emissions_map <- ggplot() +
  geom_sf(data = EJ_NC_sf, aes(fill = Identified.as.disadvantaged), 
          size = 0.1) +
  geom_sf(data = nc_plant_emissions, 
          aes(size = `Plant annual SO2 emissions (tons)`)) +
            scale_fill_manual(
    values = disadvantaged_colors,
    na.value = "white",  
    name = "Disadvantaged Status")+
  scale_size_continuous(
    name = "NOx Emissions (Tons)",
    range = c(1, 6)) + 
  labs(title = "Disadvantaged Census Tracts and\nPower Plant SO2 Emissions in NC") +
  theme(legend.position = "bottom") +
  guides(size = "none")
so2_emissions_map
```


## Question 3: What are the Environmental Justice implications of electricity power generation in North Carolina? 

### Question 3a: Are power plants primarily located in low-income and disadvantaged communities?

```{r are plant locations significant?, echo=FALSE}

#join nc plant locations and CEJST data and select relevant columns
EJ.NC_plus_plants <- st_join(EJ_NC_sf, nc_plants_counties,
                             join = st_intersects)

#run a Chi-square test
observed <- table(EJ.NC_plus_plants$Identified.as.disadvantaged)
expected <- table(EJ_NC_sf$Identified.as.disadvantaged)

chisq_test <- chisq.test(observed, p = expected / sum(expected))
chisq_test

#filter nc_plants for the type of energy that is the worst for human health 
nc_unhealthy_plants <- EJ.NC_plus_plants %>%
  filter(Plant.primary.fuel.category== 'OIL' |
           Plant.primary.fuel.category == 'GAS' |
           Plant.primary.fuel.category== 'COAL' |
           Plant.primary.fuel.category=='NUCLEAR' |
           Plant.primary.fuel.category=='BIOMASS')

#Perform Chi-square test for worst types of energy to live by
observed <- table(nc_unhealthy_plants$Identified.as.disadvantaged)
expected <- table(EJ_NC_sf$Identified.as.disadvantaged)

chisq_test <- chisq.test(observed, p = expected / sum(expected))
chisq_test

```


\newpage

# Summary and Conclusions


\newpage

# References

Bakkensen, L. A., Ma, L., Muehlenbachs, L., & Benitez, L. (2024).
    Cumulative impacts in environmental justice: Insights from economics and policy.        *Regional Science and Urban Economics, 107*, 103993.
    https://doi.org/10.1016/j.regsciurbeco.2024.103993

Rapier, R. (2024, May 20). *How Natural Gas And Renewables Dethroned Coal In America*.      Forbes. https://www.forbes.com/sites/rrapier/2024/05/20/how-natural-gas-and-renewables-dethroned-coal-in-america/

Saxena, P., & Sonwani, S. (2019). Primary Criteria Air Pollutants:
    Environmental Health Effects. In Criteria Air Pollutants and their
    Impact on Environmental Health (pp. 49–82). *Springer Singapore*.
    https://doi.org/10.1007/978-981-13-9992-3_3
    
Suh, H. H., Bahadori, T., Vallarino, J., & Spengler, J. D. (2000).
    Criteria air pollutants and toxic air pollutants. *Environmental Health                 Perspectives, 108*(suppl 4), 625–633.
    https://doi.org/10.1289/ehp.00108s4625

U.S. Council on Environmental Quality. (2024). *Climate and Economic Justice                Screening Tool, 2022*. https://screeningtool.geoplatform.gov/en/

U.S. Environmental Protection Agency. (2024). *Emissions and Generation Resource            Integrated Database (eGRID), 2022*. https://www.epa.gov/egrid/download-data 

U.S. Environmental Protection Agency. (2024). *Emissions and Generation Resource            Integrated Database (eGRID), Technical Guide 2022*.
    https://www.epa.gov/egrid/egrid-technicalguide. 